# 修复与优化：展览滚动、排行榜分类、整体样式与动画

## 概述

本任务包含三项改动：
1. 修复展览页面在部分设备上出现“右侧两层滑动条”的问题，使页面仅存在单一竖向滚动条，避免内容被截断或出现双滚动条体验异常；
2. 在排行页面移除“收藏”分类（favorites tab），只保留下载榜与点赞榜；调整 UI 与数据源；
3. 优化全局样式，增加交互动画（卡片入场、轮播切换、Tab 切换等），提升视觉体验并保持性能平衡。

## 关键概念
- Actors: 移动端用户、产品测试人员、前端开发者
- Actions: 浏览展览页、切换排行 Tab、查看详情、观察动画反馈
- Data: 剧本卡片数据（title, author, version, likes, downloads, images, tags）
- Constraints: 兼顾微信小程序与 HBuilderX 预览；动画需在常见中低端设备上无明显卡顿；不改动后端接口

## 用户场景

1. 用户在展览页垂直滚动浏览，页面只存在单一竖向滚动条，卡片完整可见，无水平溢出或双滚动条。
2. 用户进入排行页，Tab 显示“下载榜”和“点赞榜”，“收藏榜”已移除；用户切换 Tab 时有平滑过渡动画。
3. 用户在展览页看到卡片时，卡片有轻微入场动画；当用户切换图片轮播，轮播切换有平滑过渡；交互时反馈及时且不超过100ms感知延迟。

## 功能需求（可测试）

FR1 — 单一滚动条（展览）
- 在所有支持的屏幕宽度下，展览页仅应出现一个竖向滚动条。消除任何由嵌套 scroll-view 或 overflow 引起的额外滚动条。

FR2 — 元素不被截断（展览）
- 卡片右侧关键元素（点赞数、阴影等）在常见设备宽度下应完整可见；不显示横向滚动或被遮挡。

FR3 — 排行页分类调整
- 排行页 Tab 仅包含“下载榜”和“点赞榜”；移除收藏相关 UI、逻辑与测试；后端统计字段仍保留但不展示。

FR4 — 全局样式与动画
- 卡片入场（fade+translateY）动画；轮播切换（slide/fade）；Tab 切换指示器带平滑过渡；动画应可通过配置关闭以保证性能。

FR5 — 可配置与回退
- 提供动画开关（全局配置或环境变量），在性能敏感环境（低端设备或 DEBUG=false）可关闭动画。

## 验收标准（Acceptance Criteria）

AC1 — 单滚动条断言
- 在设备宽度矩阵（320, 360, 375, 390, 412px）和 HBuilderX 预览中打开展览页，不出现水平溢出，并且浏览器/小程序仅显示竖向滚动条一次。

AC2 — 元素可见性
- 对第一张卡片进行截图，右侧关键元素（点赞数）完整可见，卡片阴影与边距正常。

AC3 — 排行页 Tab 更新
- 排行页不再展示收藏（favorites）Tab；相关数据项不可见且点击索引不可达；Tab 切换正常。

AC4 — 动画与性能
- 卡片入场与轮播切换动画平滑（不出现明显抖动）；在中低端设备上单次渲染延迟增量 < 100ms。

AC5 — 可配置动画
- 在禁用动画配置下，所有动画效果被禁用且功能与布局不受影响。

## 关键实体

- ScriptCard: { id, title, version, author, likes, downloads, images[], tags[] }
- RankingsTabs: [ { key: 'downloads' }, { key: 'likes' } ]
- UIConfig: { animationsEnabled: boolean }

## 假设与约束

- 假设后端仍会提供收藏数，但前端不再展示该分类。
- 约束：不改动后端接口，仅前端代码调整与样式更改。
- 假设可以修改 `xueran/pages/exhibition/exhibition.vue` 与 `xueran/pages/rankings/rankings.vue` 以及全局样式/变量文件。

## 验证测试

- 单元测试：组件渲染测试验证没有 overflow、元素存在/消失（针对 favorites）。
- 视觉回归：在设备矩阵上对展览卡片与排行页截图对比基线。
- 性能测试：测量渲染时间并对比基线，确保不超过阈值。
- 手工测试：在微信开发者工具和真实设备上验证。

## 风险与缓解

- 风险：移除 favorites 可能影响已习惯使用收藏榜的用户。  
  缓解：在移除前记录该变更并在 UI 明显位置提供“收藏统计仍可在剧本详情查看”的提示。
- 风险：动画影响性能。  
  缓解：提供动画开关、降低动画时长并使用 CSS transform/opacity 优化。

## 可交付项

1. 规范文件（本文件）
2. 代码修复 PR（分支：`3-fix-scroll-rank-style`）包含布局修复、排行 Tab 调整与动画实现
3. 组件单元 & 视觉回归测试
4. 验收验证记录（截图与测试报告）

---  
**状态**: Draft — ready for planning

