# 007-optimize-miniapp-search

## 概述

优化小程序端的搜索接口，当前搜索只能搜索出加载的内容，应当搜索所有的内容包含未加载但在数据库中的内容。

## 背景

当前小程序的搜索功能存在以下问题：
- 搜索只在已加载到前端的剧本数据中进行过滤
- 分页加载的数据量有限，导致搜索结果不完整
- 用户无法搜索到未加载但存在于数据库中的剧本

## 目标

实现全局搜索功能，让用户能够搜索数据库中的所有剧本内容，而不仅仅是当前已加载的内容。

## 验收标准

- [ ] 用户输入搜索关键词时，能够搜索到数据库中的所有匹配剧本
- [ ] 搜索结果按相关度排序（标题匹配优先）
- [ ] 保持良好的用户体验，包括搜索防抖和加载状态
- [ ] 搜索结果支持分页浏览
- [ ] 搜索缓存优化，避免重复请求

## 技术方案

### 前端修改
- 修改搜索输入框的行为，从前端过滤改为触发API调用
- 添加搜索防抖机制，避免频繁API调用
- 优化搜索结果展示和加载状态

### 后端优化
- 确认云函数已支持全局搜索（当前listScripts已支持）
- 优化搜索查询性能
- 添加搜索相关度排序

## 风险评估

- 搜索性能：大量数据下的搜索性能需要测试
- 用户体验：搜索响应时间不能过长
- 缓存策略：需要平衡实时性和性能