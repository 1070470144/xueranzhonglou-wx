# 测试流程：使用排行榜功能 (US1)

**用户故事**: US1 - 查看使用排行榜
**测试目标**: 验证使用排行榜数据正确加载，按使用次数降序排列，前20个剧本显示正确
**测试环境**: 小程序开发工具 / 真机

## 前置条件

1. 小程序项目已正确配置
2. uniCloud云函数已部署
3. scripts集合中至少有5个status为'active'的剧本记录
4. 每个剧本都有usageCount字段（>=0）

## 测试步骤

### 基本功能测试

1. **页面访问测试**
   - 打开小程序
   - 点击底部导航栏的"排行"选项卡
   - 验证排行榜页面正常加载
   - 检查页面标题显示为"排行榜"

2. **默认选项卡验证**
   - 验证默认选中"使用排行"选项卡
   - 检查选项卡高亮状态正确

3. **数据加载测试**
   - 等待数据加载完成（显示"加载中..."状态）
   - 验证数据加载成功，无错误提示
   - 检查排行榜列表正常显示

4. **列表显示验证**
   - 验证显示前20个剧本（如果总剧本数少于20个，显示全部）
   - 检查每个排行榜项包含：
     - 排名（数字1-20或奖牌🥇🥈🥉）
     - 剧本标题
     - 作者姓名
     - 使用次数数值
     - "次使用"标签

5. **排序验证**
   - 检查排行榜按使用次数降序排列
   - 验证第一名使用次数 >= 第二名使用次数
   - 检查排名连续且正确（1, 2, 3...）

6. **奖牌显示测试**
   - 验证前三名显示奖牌图标（🥇🥈🥉）
   - 检查第4名及以后显示数字排名

### 交互测试

7. **选项卡切换**
   - 点击"点赞排行"选项卡
   - 验证切换到点赞排行榜
   - 再切换回"使用排行"
   - 检查数据重新加载

8. **剧本详情跳转**
   - 点击排行榜任意一项
   - 验证跳转到剧本详情页面
   - 检查传递的参数正确（剧本ID）

### 边界情况测试

9. **数据为空测试**
   - 临时修改云函数返回空数据
   - 验证显示"暂无排行数据"提示
   - 恢复正常数据

10. **网络错误测试**
    - 模拟网络断开
    - 验证显示错误提示和重试按钮
    - 点击重试按钮重新加载

11. **加载状态测试**
    - 检查加载过程中显示"加载中..."状态
    - 验证加载完成后状态消失

### 下拉刷新测试

12. **下拉刷新**
    - 向下拖拽页面
    - 验证触发下拉刷新
    - 检查数据重新加载
    - 验证刷新完成后停止动画

## 验收标准

### ✅ 通过标准

- [ ] 页面正常加载，无崩溃
- [ ] 数据在2秒内加载完成
- [ ] 排行榜按使用次数正确降序排列
- [ ] 前三名显示奖牌图标，其他显示数字排名
- [ ] 每个列表项显示完整的剧本信息
- [ ] 点击列表项成功跳转到剧本详情
- [ ] 选项卡切换正常工作
- [ ] 错误情况有适当的用户提示
- [ ] 下拉刷新功能正常

### ❌ 失败标准

- [ ] 页面加载失败或崩溃
- [ ] 数据加载超过5秒
- [ ] 排行榜排序错误
- [ ] 列表项信息显示不完整
- [ ] 跳转功能异常
- [ ] 网络错误无用户反馈
- [ ] UI显示不符合设计规范

## 测试数据要求

准备至少10个测试剧本，包含不同的使用次数：
- 剧本A: usageCount = 1000
- 剧本B: usageCount = 800
- 剧本C: usageCount = 600
- 剧本D: usageCount = 400
- 剧本E: usageCount = 200
- 其他剧本: usageCount = 0-100

## 性能基准

- **首次加载**: < 2秒
- **选项卡切换**: < 1秒
- **列表滚动**: 流畅无卡顿
- **内存使用**: < 50MB

## 回归测试

每次代码变更后，执行以下快速检查：
1. 打开排行榜页面
2. 验证使用排行数据正确显示
3. 切换到其他排行榜再切换回来
4. 点击任意剧本项验证跳转

## 备注

- 测试需要在真实的微信小程序环境中进行
- 建议同时在iOS和Android设备上测试
- 记录测试过程中的任何异常表现