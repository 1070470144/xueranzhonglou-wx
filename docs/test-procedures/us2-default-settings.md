# 测试流程：默认设置应用 (US2)

## 测试目的
验证批量上传过程中默认设置的自动应用，特别是"娱乐"标签和激活状态的默认设置功能。

## 前置条件
- 批量上传功能已启动
- 准备多种类型的JSON文件：
  - 无标签信息的JSON文件
  - 有其他标签但无"娱乐"标签的JSON文件
  - 明确指定状态的JSON文件
  - 未指定状态的JSON文件

## 测试步骤

### 步骤1: 验证默认标签应用
1. 上传包含不同标签情况的JSON文件：
   - 文件A：无任何标签信息
   - 文件B：有"推理"标签但无"娱乐"标签
   - 文件C：已有"娱乐"标签
2. 检查文件解析后的元数据：
   - 文件A：应自动获得"娱乐"标签
   - 文件B：应在"推理"基础上添加"娱乐"标签
   - 文件C：应保持原有标签不变

### 步骤2: 验证默认状态设置
1. 上传包含不同状态情况的JSON文件：
   - 文件D：明确指定status为"inactive"
   - 文件E：无状态信息
   - 文件F：status为空值
2. 检查状态设置结果：
   - 文件D：应保持"inactive"状态
   - 文件E：应自动设置为"active"
   - 文件F：应自动设置为"active"

### 步骤3: 测试用户覆盖默认设置
1. 在预览界面修改默认设置：
   - 将自动添加的"娱乐"标签更改为其他标签
   - 将自动设置的"active"状态更改为"inactive"
2. 验证用户修改优先于默认设置

### 步骤4: 验证批量默认设置
1. 选择多个文件进行批量操作：
   - 批量添加自定义标签到所有文件
   - 批量修改状态为所有文件
2. 验证批量操作正确覆盖默认设置

### 步骤5: 测试默认设置持久性
1. 完成上传过程并等待作业完成
2. 在剧本列表中检查新创建的剧本：
   - 验证标签设置正确应用
   - 验证状态设置正确应用
   - 确认用户修改覆盖了默认设置

### 步骤6: 验证默认设置一致性
1. 进行多次批量上传测试
2. 确认每次上传都应用相同的默认规则
3. 验证默认设置不受其他上传操作影响

## 成功标准
- [ ] 无标签信息的文件自动获得"娱乐"标签
- [ ] 有其他标签的文件在保留原有标签基础上添加"娱乐"标签
- [ ] 无状态信息的文件自动设置为"active"状态
- [ ] 用户修改能够覆盖默认设置
- [ ] 上传后的剧本正确反映默认设置和用户修改
- [ ] 默认设置规则在多次上传中保持一致

## 配置验证
- [ ] 默认标签设置：娱乐
- [ ] 默认状态设置：active
- [ ] 标签添加逻辑：不覆盖现有标签，仅补充缺失的"娱乐"标签
- [ ] 状态设置逻辑：仅在无明确状态时应用默认值

## 边界情况测试
- JSON文件包含空标签数组
- JSON文件状态字段为null或undefined
- 混合有状态和无状态的文件批量上传
- 默认设置与用户自定义设置的冲突处理

## 预期结果
- 默认设置自动应用，提高上传效率
- 用户仍能完全控制最终设置
- 默认设置规则清晰且一致
- 系统在有明确信息时不覆盖用户意图