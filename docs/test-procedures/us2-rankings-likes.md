# 测试流程：点赞排行榜功能 (US2)

**用户故事**: US2 - 查看点赞排行榜
**测试目标**: 验证点赞排行榜数据正确加载，按点赞数降序排列，前20个剧本显示正确
**测试环境**: 小程序开发工具 / 真机

## 前置条件

1. 已完成用户故事1的实现和测试
2. 小程序排行榜页面可以正常加载使用排行数据
3. scripts集合中至少有5个status为'active'的剧本记录
4. 每个剧本都有likes字段（>=0）

## 测试步骤

### 基本功能测试

1. **选项卡切换测试**
   - 从使用排行切换到点赞排行
   - 验证选项卡高亮状态正确切换
   - 检查页面标题保持为"排行榜"

2. **数据加载测试**
   - 等待点赞排行数据加载完成
   - 验证数据加载成功，无错误提示
   - 检查排行榜列表正常显示

3. **列表显示验证**
   - 验证显示前20个剧本（如果总剧本数少于20个，显示全部）
   - 检查每个排行榜项包含：
     - 排名（数字1-20或奖牌🥇🥈🥉）
     - 剧本标题
     - 作者姓名
     - 点赞数数值
     - "个点赞"标签

4. **排序验证**
   - 检查排行榜按点赞数降序排列
   - 验证第一名点赞数 >= 第二名点赞数
   - 检查排名连续且正确（1, 2, 3...）

5. **数据一致性测试**
   - 比较使用排行和点赞排行的剧本列表
   - 验证相同剧本在不同排行中的信息一致
   - 检查作者和标题信息正确

### 点赞数据特有测试

6. **点赞数值显示**
   - 测试各种点赞数值：
     - 0点赞的情况
     - 小数值（1-10）
     - 中等数值（100-1000）
     - 大数值（10000+）
   - 验证数值格式化正确

7. **点赞数据更新测试**
   - 如果可能，模拟点赞数变化
   - 验证排行榜反映最新的点赞数据
   - 检查排序在数据变化后正确更新

### 交互测试

8. **选项卡频繁切换**
   - 在使用排行和点赞排行之间快速切换
   - 验证每次切换都触发数据重新加载
   - 检查UI状态正确更新

9. **剧本详情跳转**
   - 从点赞排行点击任意剧本项
   - 验证跳转到正确的剧本详情页面
   - 检查传递的剧本ID正确

### 边界情况测试

10. **相同点赞数排序**
    - 准备多个剧本有相同点赞数的情况
    - 验证相同点赞数的剧本按合理规则排序（如剧本ID）
    - 检查排名仍然连续

11. **点赞数据为0的情况**
    - 测试所有剧本点赞数为0的情况
    - 验证排行榜仍能正常显示
    - 检查排序稳定

12. **网络异常测试**
    - 模拟网络断开情况
    - 验证点赞排行加载失败时的错误处理
    - 测试重试功能

## 验收标准

### ✅ 通过标准

**数据正确性**
- [ ] 点赞排行按点赞数正确降序排列
- [ ] 相同点赞数的剧本排序稳定合理
- [ ] 数值显示格式正确（包括大数字）

**功能完整性**
- [ ] 选项卡切换到点赞排行正常工作
- [ ] 数据加载时间 < 2秒
- [ ] 列表显示格式与使用排行一致

**用户体验**
- [ ] 点击剧本项成功跳转详情页
- [ ] 加载状态和错误提示友好
- [ ] 界面切换流畅无卡顿

### ❌ 失败标准

- [ ] 点赞排行数据排序错误
- [ ] 数值显示格式异常
- [ ] 选项卡切换功能异常
- [ ] 网络错误无适当反馈
- [ ] 界面显示不符合设计规范

## 测试数据要求

准备测试剧本数据，确保点赞数分布合理：
- 高点赞剧本：likes >= 1000
- 中等点赞剧本：likes 100-999
- 低点赞剧本：likes 1-99
- 零点赞剧本：likes = 0

包含至少3个相同点赞数的剧本，用于测试排序稳定性。

## 性能基准

- **数据加载**: < 2秒
- **选项卡切换**: < 1秒
- **列表渲染**: < 500ms
- **内存使用**: < 50MB

## 与US1的对比测试

- 相同剧本在两个排行榜中的信息一致
- UI布局和交互行为保持一致
- 错误处理机制相同
- 性能表现相近

## 回归测试要点

每次修改后重点检查：
1. 点赞排行数据是否正确排序
2. 数值显示是否正常
3. 与使用排行的切换是否流畅
4. 边界情况是否处理正确

## 备注

- 需要真实的点赞数据进行测试
- 建议在有大量数据的生产环境中测试
- 注意测试数据更新后的排行榜变化