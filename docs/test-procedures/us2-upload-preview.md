# 测试流程：元数据预览和编辑 (US2)

## 测试目的
验证批量上传过程中的元数据预览、编辑和确认功能，确保用户能够查看和修改提取的元数据信息。

## 前置条件
- 批量上传功能已启动并完成文件解析
- 至少有3个JSON文件被成功解析并提取了元数据
- 用户界面显示元数据预览表格

## 测试步骤

### 步骤1: 访问元数据预览界面
1. 完成文件选择和解析过程
2. 观察界面是否显示"元数据预览"或"确认上传"区域
3. 验证预览表格包含以下列：
   - 文件名
   - 标题
   - 作者
   - 描述
   - 标签
   - 状态

### 步骤2: 验证元数据提取准确性
1. 检查每个文件的元数据提取结果：
   - 标题：应从JSON中正确提取或使用文件名作为默认值
   - 作者：应从JSON中提取或显示为空
   - 描述：应从JSON中提取或显示为空
   - 标签：应包含"娱乐"标签（默认）
   - 状态：应默认为"激活"

### 步骤3: 测试单个文件元数据编辑
1. 点击某个文件的"编辑"按钮或行内编辑功能
2. 修改以下字段：
   - 标题：更改为自定义标题
   - 作者：添加或修改作者名
   - 描述：添加或修改描述
   - 标签：添加其他标签或移除"娱乐"标签
3. 保存更改并验证界面更新

### 步骤4: 测试批量元数据编辑
1. 选择多个文件进行批量编辑
2. 测试以下批量操作：
   - 为所有选中文件添加统一标签（如"推理"）
   - 批量修改状态（如改为"未激活"）
   - 批量设置作者信息
3. 验证批量操作正确应用到所有选中文件

### 步骤5: 验证元数据验证
1. 测试无效输入的处理：
   - 空标题：应显示错误提示
   - 过长字段：应限制字符长度
   - 无效标签：应验证标签格式
2. 验证错误信息清晰且指导性强

### 步骤6: 测试预览和确认流程
1. 完成所有元数据编辑后点击"开始上传"
2. 验证最终确认对话框显示：
   - 总文件数
   - 每个文件的最终元数据摘要
   - 上传影响说明（如将创建多少个剧本）

### 步骤7: 验证上传后数据一致性
1. 等待上传完成
2. 在剧本列表中查找新创建的剧本
3. 验证每个剧本的元数据与预览时设置的一致：
   - 标题、作者、描述正确
   - 标签包含用户设置的值
   - 状态符合预期

## 成功标准
- [ ] 元数据预览表格显示完整且准确
- [ ] 单个文件编辑功能正常工作
- [ ] 批量编辑功能正确应用到多个文件
- [ ] 元数据验证提供有用的错误提示
- [ ] 上传后的剧本元数据与预览时设置一致
- [ ] 用户界面响应流畅，无明显延迟

## 边界情况测试
- 只有一个文件的批量编辑
- 所有文件使用默认元数据
- 混合编辑（部分文件自定义，部分使用默认）
- 大量文件的预览性能
- 特殊字符和多语言文本处理

## 预期结果
- 用户能够完全控制上传剧本的元数据
- 预览和编辑过程直观易用
- 元数据准确传递到最终的剧本记录
- 批量操作提高编辑效率