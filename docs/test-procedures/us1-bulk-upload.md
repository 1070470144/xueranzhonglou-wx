# 测试流程：文件夹选择和JSON处理 (US1)

## 测试目的
验证批量上传功能能够正确选择文件夹并处理JSON文件，包括递归扫描、文件过滤和基础元数据提取。

## 前置条件
- 管理员账号已登录
- 浏览器支持文件夹选择 (Chrome/Edge推荐)
- 准备测试文件夹包含：
  - 5-10个有效的JSON文件（不同大小）
  - 2-3个无效的JSON文件（格式错误、缺少必要字段）
  - 2-3个非JSON文件（.txt, .md等）
  - 子文件夹结构（至少2层嵌套）

## 测试步骤

### 步骤1: 访问批量上传页面
1. 打开管理后台
2. 导航到"剧本管理" → "列表"页面
3. 点击页面顶部的"批量上传"按钮
4. 验证上传面板正确显示

### 步骤2: 选择文件夹并验证文件扫描
1. 点击"选择文件夹"选项
2. 在文件选择对话框中选择包含测试文件的文件夹
3. 观察系统行为：
   - 显示"正在解析文件..."提示
   - 进度条显示文件扫描进度
   - 只识别.json文件，忽略其他格式文件

### 步骤3: 验证文件清单显示
1. 等待解析完成
2. 检查文件清单：
   - 显示找到的JSON文件数量
   - 显示忽略的非JSON文件数量
   - 每个JSON文件显示文件名和基本信息

### 步骤4: 验证元数据提取
1. 检查每个文件的元数据提取结果：
   - 标题(title)：从JSON中正确提取或使用文件名作为默认值
   - 作者(author)：从JSON中提取或显示为空
   - 描述(description)：从JSON中提取或显示为空
2. 记录提取成功/失败的文件数量

### 步骤5: 测试无效文件处理
1. 观察无效JSON文件的处理：
   - 格式错误的JSON文件应标记为错误
   - 缺少必要字段的文件应标记为警告
   - 错误信息应清晰描述问题

### 步骤6: 验证用户确认流程
1. 检查上传前确认界面：
   - 显示总文件数、有效文件数、无效文件数
   - 提供"开始上传"按钮
   - 显示预期处理时间估算

## 成功标准
- [ ] 文件夹选择功能正常工作
- [ ] 系统正确识别和过滤JSON文件
- [ ] 递归扫描子目录功能正常
- [ ] 基础元数据提取算法正确工作
- [ ] 无效文件被正确识别和标记
- [ ] 用户界面响应流畅，无明显卡顿
- [ ] 错误信息清晰易懂

## 性能基准
- 文件夹扫描时间：< 30秒 (100个文件)
- 内存使用峰值：< 100MB
- UI响应延迟：< 2秒

## 边界情况测试
- 空文件夹处理
- 仅包含非JSON文件的文件夹
- 超大JSON文件（>10MB）
- 网络连接中断情况
- 浏览器权限不足情况

## 预期结果
- 所有有效JSON文件被正确识别和处理
- 无效文件被标记但不阻止其他文件处理
- 用户获得清晰的状态反馈
- 系统为后续上传步骤做好准备